<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Aspect-Oriented Programming in Javascript &middot; Chaojie's Blog
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <img src="/images/profile.png">
    <p>Writings inspired from daily life.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">All posts</a>
        
      
    
      
    
      
        
      
    
    
    <a class="sidebar-nav-item" href="https://github.com/cjackie">GitHub</a>
    <a class="sidebar-nav-item" href="https://www.linkedin.com/pub/chaojie-wang/6b/a7a/290">Linkedin</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Chaojie's Blog</a>
            <small>starry night</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Aspect-Oriented Programming in Javascript</h1>
  <span class="post-date">25 Jun 2014</span>
  <h2>Aspect-Oriented Programming</h2>

<p>It might sound complicated, but the idea is in fact very simple, which is adding new behavior to a function. This can be done using in object-oriented way, but for some problems, AOP is a better solution. Let&#39;s say you would like to print something before the call, and print something after that call for debugging purposes. Of course you can just make a subclass and add those functionality. However, it feels very unnatural. With AOP, it&#39;s straight forward: add one behavior before the call and another one after the call. The abstraction really free you from thinking details about class relationships, and other methods, and make you focus more on what the code does.<br>
  Let&#39;s give an example of AOP:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript">function Person(name) { 
  this.name = name
}

Person.prototype.say = funciton() {
  console.log(this.name);
}
</code></pre></div>
<p>Now you make an &#39;instance&#39; of it (in reality, better call it create a new an object)</p>
<div class="highlight"><pre><code class="language-js" data-lang="js">var jack = new Person('jack');
</code></pre></div>
<p>Then you change you mind and say, &quot;you know what, let&#39;s say &#39;hello everyone&#39; before say the name&quot;. You just want to change the <code>say</code> function, nothing else.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js">var say = jack.say;
jack.say = function() {
  console.log('hello everyone');
  say.call(jack);
};
</code></pre></div>
<p>Thanks to closure, it works. That&#39;s it, 4 lines of codes. Now, whenever jack call <code>say</code> function, it will print out &#39;hello everyone&#39;, before whatever old method say does. Wow, this is neat. <br>
Let&#39;s break it down here. <code>var say = jack.say;</code> this is used to save the reference to original <code>say</code> function. then we redefine the <code>say</code> function for jack, <code>jack.say = function() {...};</code>. Inside the function, we will say hello to every, <code>console.log(&#39;hello everyone&#39;);</code>, then call the original function <code>say.call(jack);</code>. <code>say.call(jack);</code> is the way to invoke the old function, you might wonder why don&#39;t we just invoke the function like <code>say()</code>. This is because that <code>say</code> has different context, when it should be within the <code>jack</code> context. so we need to reinforce the context by using the method <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call">call</a></p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2014/07/17/email/">
            Email
            <small>17 Jul 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2014/07/09/www/">
            How html, css and js work in browsers
            <small>09 Jul 2014</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2014/07/05/mindset/">
            一些感想
            <small>05 Jul 2014</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
