---
layout: post
title: Email
---
### I just want to send an email
Today at work, we tried to make an alarm functionality for our arduino system. It's going to be either text message or email. Ironically, arduino with GSM connect from T-Mobile won't be able to send a message! So, we had to find another way.</br>
We knew how to make a http connection through arduino gsm shield. So, we are going to take that as the base to send some kind of "alarm". Here are some proposals we had:

- find a vendor that will provide restful API to send email or text message
- connect email directly from arduino.

As a result, we spent a lot of time looking for a good vendor. It turned out they all need monthly fee, which is very cheap though. After exploring their APIs, which obviously has not arduino support. So we had to find out how http request API works underneath the hood, which I'm very glad we did. In this process, we, at least I, learned alot about http protocol and how it works.

<!--break-->

### How http works.
Having worked with http for a some time, sometimes I just forgot that It's just a protocol(an agreement between server and client how to communicate). Many website offers API for different programming languages to make http requests, but at the end, they all become plain text(later zeros and ones) and get send over to the other. If you keep this in mind, You will know that, as long as you can get a text sent over network, you will be able to request info from other websites. This is powerful insight, you don't need abstractions provided by modules/libraries of different languages. </br>
Now, let's talk about how http works. We are all familiar with http in browsers - You enter a website url, and hit enter, and wola there is a beautiful webpage. What's going on is a http request is being sent over the network. There are two type of http request, one is POST, the other is GET. HTTP contains lots of headers to describe what kind of request is. For example Content-Type specifies what kind of content the request body has. It would be json, html and so on. Headers are important, and they are often hidden away from developers when they use a module or library for http. As a result, when you write an application on top of HTTP using those modules/libraries, things will work and feel like magic, but at the end it's just a http text being past back and forth. 

#### Another way, send an email directly from arduino
At the end, we were able to send a text message using third party's RESTful API. However it wasn't free. And, my partner has found a way to send the email directly from telnet without any authenication. wow!!! what! yes, you heard it right. That actually surprised me. Then I tried it with telnet, then I was able to send an email to myself. I specified It was sent from my own address without any authenication. But, the email was labeled "might not be sent from the user". Okay, That makes sense. otherwise how broken is the email protocol! However it doesn't display that message on the mobile, which is concerning. After digging more info about email, I sort of got how the email system worked. they are sent using SMTP protocol. And using telnet, you can connect to google email server and instruct it to send an email. What's more, I learned that telnet uses port 25. And many protocol like ssh, whois protocol and alot of more unheard protocols have their own specified ports. wow, That means I can use it to connect to different ports and use different functionalities of a server. That's awesome!</br>
Back to the arduino, we didn't make it make on arduino. We think it might have something to do with that the fact that we uses gsm and the google mail server will deny the access. But I think it's worth it. Because I learned a lot in the process.
